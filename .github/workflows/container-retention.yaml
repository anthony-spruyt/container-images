name: Container Retention Policy

on:
  schedule:
    - cron: "0 5 * * 0" # Weekly, Sundays at 5 AM UTC
  workflow_dispatch:
    inputs:
      dry_run:
        description: "Dry run (no deletions)"
        type: boolean
        default: true

jobs:
  cleanup:
    runs-on: ubuntu-latest
    steps:
      - uses: snok/container-retention-policy@v3.0.1
        with:
          account: anthony-spruyt
          token: ${{ secrets.CONTAINER_RETENTION_TOKEN }}
          image-names: "gastown-dev megalinter-*"
          cut-off: 4w
          keep-n-most-recent: 5
          dry-run: ${{ inputs.dry_run || 'false' }}
